<link rel="import" href="../elements.html">

<!--
`<uql-mega-menu>` is a horizontal main menu, composite of paper-tabs and iron-dropdown components.
It's a sub-component of <uql-menu> which contains horizontal and vertical menu.

Example:
      <uql-mega-menu></uql-mega-menu>

@demo uql-mega-menu/demo/index.html
-->

<dom-module id="uql-mega-menu">

  <style is="custom-style" include="common-styles">
    :host {
      font-family: var(--font-family);
    }

    .menu-container {
      @apply(--uq-box-shadow);
    }

    .menu-container,
    .menu-content {
      background-color: var(--menu-background-color);
    }

    .menu-container,
    .menu-content,
    paper-tabs {
      height: 67px;
    }

    .menu-content {
      margin: 0 auto;
      max-width: var(--max-width);
      width: 100%;
    }

    /* make top-level menu sized according to label, not same size for all */
    paper-tab {
      @apply(--layout-flex-none);
      /*font-size: 16px;*/
      /*font-weight: 300;*/
    }

    div.subtext {
      color: var(--menu-sub-text-color);
      font-size: 90%;
      margin-top: -8px;
    }

    paper-tab.sub-menu-opened {
      background-color: var(--menu-open-background-color);
    }

    .dropdown-content {
      background-color: var(--menu-open-background-color);
      @apply(--uq-box-shadow);
      @apply(--layout-flex);
      @apply(--layout-horizontal);
    }

    .has-right-true {
      width: 480px;
    }

    .has-right-false {
      width: 240px;
    }

    .dropdown-content .sub-menu{
      @apply(--layout-flex);
      padding-top: 15px;
    }

    .sub-menu.uql-submenu-right {
      border-left-width: thin;
      border-left-style: solid;
      border-color: var(--menu-border-color);
    }

    .sub-menu {
      background-color: var(--menu-open-background-color);
      margin: 0px;
      padding: 0px;
    }

    .sub-menu a {
      @apply(--layout-flex);
      @apply(--layout-vertical);

      @apply(--menu-item);
    }

    .sub-menu a:hover {
      background-color: var(--menu-hover-background-color);
    }

    .sub-menu a.iron-selected {
      font-weight: 500 !important;
    }

    /*paper-tab /deep/ paper-ripple.paper-tab {*/
      /*color: var(--menu-hover-background-color);*/
    /*}*/

    /*paper-tab:focus /deep/ .tab-content.paper-tab {*/
      /*font-weight: 400;*/
    /*}*/

    iron-dropdown {
      position: absolute !important;
    }

    /*paper-tab:not(.iron-selected) /deep/ .tab-content.paper-tab {*/
      /*opacity:1!important;*/
    /*}*/

  </style>

  <template>

    <div class="menu-container">
      <div class="menu-content loading" unresolved>
        <paper-tabs id="topMenu" on-tap="_topMenuSelected">
          <template is="dom-repeat" items="{{menu.items}}">
            <paper-tab data-item-index$="{{index}}">
              {{item.label}}
              <template is="dom-if" if="{{item.items}}">
                <iron-icon icon="icons:icons:arrow-drop-down"></iron-icon>
              </template>
            </paper-tab>
          </template>
        </paper-tabs>

        <template is="dom-repeat" items="{{menu.items}}">
          <iron-dropdown id$="subMenu{{index}}" allow-outside-scroll="true" horizontal-align="left" vertical-align="top" vertical-offset="67"
                         on-iron-overlay-closed="_subMenuClosed" data-item-index$="{{index}}">
            <div class$="dropdown-content has-right-{{item.hasRight}}">
              <div class="sub-menu">
                <template is="dom-repeat" items="{{item.items}}" as="subItem">
                  <template is="dom-if" if="{{!subItem.right}}">
                    <a class$="paper-item {{subItem.class}}" href="{{subItem.href}}" on-tap="closeDropdown">
                      <div>{{subItem.label}}</div>
                      <div class="subtext">{{subItem.subtext}}</div>
                    </a>
                  </template>
                </template>
              </div>

              <template is="dom-if" if="{{item.hasRight}}">
                <div class="sub-menu uql-submenu-right">
                  <template is="dom-repeat" items="{{item.items}}" as="subItem">
                    <template is="dom-if" if="{{subItem.right}}">
                      <a class$="paper-item {{subItem.class}}" href="{{subItem.href}}" on-tap="_closeDropdown">
                        <div>{{subItem.label}}</div>
                        <div class="subtext">{{subItem.subtext}}</div>
                      </a>
                    </template>
                  </template>
                </div>
              </template>

            </div>
          </iron-dropdown>
        </template>

      </div>
    </div>

  </template>

  <script src="uql-mega-menu.js"></script>

</dom-module>